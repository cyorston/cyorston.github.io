<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Cole Yorston Portfolio</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<script src="https://d3js.org/d3.v7.min.js"></script>
<style>
  body { font-family:'Segoe UI',sans-serif; background:#0e0e0e; color:#f2f2f2; margin:0; padding:0; overflow-x:hidden;}
  .sidebar {position:fixed; top:0; left:0; width:80px; height:100%; background:#1b1b1b; display:flex; flex-direction:column; align-items:center; padding:20px 0; gap:25px; z-index:1000;}
  .sidebar a {color:#ffd166; text-decoration:none; font-size:1.5em; transition:0.3s;}
  .sidebar a:hover {color:#06d6a0;}
  main {margin-left:100px;}
  header {background:#1b1b1b; padding:40px 20px; text-align:center; display:flex; flex-direction:column; align-items:center; gap:15px;}
  header img {width:120px; height:120px; border-radius:50%; border:3px solid #ffd166;}
  header h1 {font-size:2.5em; margin:0; color:#ffd166;}
  header p {font-size:1.2em; color:#ccc; max-width:1100px;}
  section {padding:60px 10%;}
  h2 {color:#ffd166; border-bottom:2px solid #ffd166; display:inline-block; margin-bottom:20px;}

  /* Timeline (unchanged) */
  .timeline {position:relative; margin:0 auto; width:100%; max-width:950px;}
  .timeline-container {padding:25px 40px; position:relative; width:50%; opacity:0; transform:translateY(50px); transition:all 0.9s ease-out;}
  .timeline-container.visible {opacity:1; transform:translateY(0);}
  .timeline-container.left {left:0;}
  .timeline-container.right {left:50%;}
  .timeline-container::after {content:""; position:absolute; width:25px; height:25px; right:-13px; background-color:#ffd166; border:4px solid #0e0e0e; top:20px; border-radius:50%; z-index:1;}
  .timeline-container.right::after {left:-13px;}
  .timeline-content {position:relative; padding:25px; background:rgba(0,0,0,0.75); border-radius:10px; overflow:hidden; z-index:2; box-shadow:0 0 15px rgba(0,0,0,0.6);}
  .timeline-banner {position:absolute; top:0; left:0; width:100%; height:100%; object-fit:cover; opacity:0.25; z-index:1;}
  .timeline-content h3, .timeline-content p {position:relative; z-index:2;}
  .timeline-container.left .timeline-content {margin-right:100px;}
  .timeline-container.right .timeline-content {margin-left:100px;}
  @media screen and (max-width:768px){ .timeline-container{width:100%; padding-left:60px; padding-right:25px;} .timeline-container.right{left:0;} .timeline-container::after{left:10px;} .timeline-content{margin:0;} }

  /* Skills Network */
  #skillsGraph {width:100%; height:560px; border:1px solid #444; border-radius:10px; background:#111; position:relative; overflow:hidden;}
  .skill-tooltip {position:absolute; background:#21262d; color:#fff; padding:6px 10px; border-radius:5px; pointer-events:none; font-size:12px; z-index:10000; display:none;}
  line.link-line{stroke:#2ec4b6; stroke-width:2; opacity:0.9;}
  circle.skill-node{cursor:pointer; stroke:#fff; stroke-width:1.2px; transition:all 0.15s;}
  text.skill-label{font-size:11px; fill:#fff; pointer-events:none; user-select:none; font-weight:600;}

  /* Legend */
  .legend {position:absolute; right:12px; top:12px; z-index:2000; background:rgba(0,0,0,0.6); padding:10px; border-radius:8px; border:1px solid rgba(255,209,102,0.08);}
  .legend .item {display:flex; align-items:center; gap:8px; margin:6px 2px;}
  .legend .swatch {width:14px; height:14px; border-radius:4px; flex:0 0 14px;}

  /* Floating project panel */
  .project-panel {position:fixed; right:20px; top:120px; width:360px; max-width:40vw; height:68vh; background:linear-gradient(180deg, rgba(27,27,27,0.98), rgba(12,12,12,0.96)); border:1px solid #333; border-left:4px solid #ffd166; box-shadow:0 12px 30px rgba(0,0,0,0.6); border-radius:10px; padding:16px; overflow:auto; z-index:3000; display:none;}
  .project-panel h3 {margin:0 0 12px 0; color:#ffd166;}
  .project-card {background:rgba(255,255,255,0.03); padding:10px; border-radius:8px; margin-bottom:10px;}
  .project-card h4 {margin:0 0 6px 0;}
  .project-card img {width:100%; height:auto; border-radius:6px; margin-top:8px;}
  .project-panel .clear-btn {background:#222; color:#ffd166; border:1px solid rgba(255,209,102,0.15); padding:8px 10px; border-radius:6px; cursor:pointer; margin-top:6px;}

  /* Bubble lists */
  .bubble-container {display:flex; flex-wrap:wrap; gap:12px; margin-top:20px;}
  .bubble {padding:12px 18px; background:#21262d; border-radius:20px; cursor:pointer; color:#fff; transition:all 0.3s;}
  .bubble:hover {background:#06d6a0; color:#0e0e0e;}
  .bubble.active {background:#ffd166; color:#111;}

  /* Drilldown inline */
  .detail-container{margin-top:20px; background:#1b1b1b; padding:20px; border-radius:10px; display:none;}
  .detail-container img{max-width:100%; margin-top:10px; border-radius:8px;}

  /* small responsive tweaks */
  @media (max-width:1100px){ .project-panel{ right:12px; top:100px; width:300px; } }
  @media (max-width:820px){ .project-panel{ display:none !important; } }
</style>
</head>
<body>

<div class="sidebar">
  <a href="mailto:yorston.cole@gmail.com"><i class="fa-solid fa-envelope"></i></a>
  <a href="assets/Cole_Yorston_Resume.pdf" download><i class="fa-solid fa-file-arrow-down"></i></a>
  <a href="https://www.linkedin.com/in/cole-yorston/" target="_blank"><i class="fab fa-linkedin"></i></a>
  <a href="https://github.com/cyorston" target="_blank"><i class="fab fa-github"></i></a>
</div>

<main>
  <header>
    <img src="assets/img/Headshot.png" alt="Cole Yorston Headshot">
    <h1>Cole Yorston</h1>
    <p>As a Lead Test Engineer for Dynamic Systems at GE Vernova, I work at the intersection of research, analytics, and real-world innovation—developing advanced data acquisition and analytical methods for next-generation gas turbines. My experience spans published research on real-time machine learning pipelines and hands-on algorithm development for rotating machinery, bridging mechanical engineering and data science to turn complex data into practical, performance-driven insights. Grounded by my education at the University of Georgia and Georgia Tech, I’m driven to transform data into measurable impact through innovation and continuous learning.</p>
  </header>

  <section id="career">
    <h2>Career Timeline</h2>
    <div class="timeline" id="careerTimeline"></div>
  </section>

  <section id="education">
    <h2>Education</h2>
    <div class="timeline" id="educationTimeline"></div>
  </section>

  <section id="skills">
    <h2>Skills</h2>
    <div id="skillsGraph"></div>
    <!-- floating project panel -->
    <div id="projPanel" class="project-panel" aria-hidden="true">
      <h3 id="projPanelTitle">Projects using: <span id="projSkillName"></span></h3>
      <div id="projList"></div>
      <button id="clearSelection" class="clear-btn">Clear selection</button>
    </div>
  </section>

  <section id="projects">
    <h2>Projects</h2>
    <div class="bubble-container" id="projectBubbles"></div>
    <div id="projectDetails" class="detail-container"></div>
  </section>

  <section id="publications">
    <h2>Publications</h2>
    <div class="bubble-container" id="pubBubbles"></div>
    <div id="pubDetails" class="detail-container"></div>
  </section>

  <section id="certifications">
    <h2>Certifications</h2>
    <div class="bubble-container" id="certBubbles"></div>
  </section>
</main>

<div class="skill-tooltip" id="skillTooltip"></div>

<script>
/* --------------------------
   Timelines (unchanged)
   -------------------------- */
const careerData=[
  {side:"left", banner:"assets/img/ge_banner.jpg", title:"Lead Test Engineer – Dynamic Systems, GE Vernova (2025–Present)", description:"Leading data-driven testing and analytics for dynamic gas turbine systems."},
  {side:"right", banner:"assets/img/textron_banner.jpg", title:"Data Scientist – Textron Specialized Vehicles (2024–2025)", description:"Implemented anomaly detection and ETL pipelines to improve quality metrics."},
  {side:"left", banner:"assets/img/textron_banner.jpg", title:"Test Engineer – Textron Specialized Vehicles (2023–2024)", description:"Built visualization pipelines and automated test data validation."},
  {side:"right", banner:"assets/img/uga_banner.jpg", title:"Graduate Research Assistant – UGA Innovation Factory (2022–2023)", description:"Engineered near-real-time ML classifiers for IoT systems with 2 publications."}
];

const educationData=[
  {side:"left", banner:"assets/img/uga_banner.jpg", title:"BSME – University of Georgia (2018–2022)", description:"Bachelor of Science in Mechanical Engineering. Focus on design optimization."},
  {side:"right", banner:"assets/img/uga_banner.jpg", title:"MS Engineering – University of Georgia (2022–2023)", description:"Developed IoT-integrated pipelines for diagnostics."},
  {side:"left", banner:"assets/img/gt_banner.jpg", title:"MS Analytics – Georgia Tech (2025–Present)", description:"Specializing in Bayesian hierarchical modeling and predictive analytics."}
];

function populateTimeline(containerId,data){
  const container=document.getElementById(containerId);
  container.innerHTML = ""; // reset
  data.forEach(d=>{
    const div=document.createElement("div");
    div.className="timeline-container "+d.side;
    div.innerHTML=`<div class="timeline-content">
      <img src="${d.banner}" class="timeline-banner"/>
      <h3>${d.title}</h3>
      <p>${d.description}</p>
    </div>`;
    container.appendChild(div);
  });
}
function animateTimeline(containerId){
  document.querySelectorAll(`#${containerId} .timeline-container`).forEach(el=>{
    const observer=new IntersectionObserver(entries=>{
      entries.forEach(entry=>{
        if(entry.isIntersecting) entry.target.classList.add("visible");
      });
    },{threshold:0.2});
    observer.observe(el);
  });
}

/* --------------------------
   Bubbles (unchanged)
   -------------------------- */
const projects=[
  {title:"CFB 5B Power Rankings", description:"Predicts college football matchups with ensemble ML.", images:["assets/img/5B_Demo.JPG"]},
  {title:"Trendiment", description:"BERT-based sentiment analysis for stock market pulse.", images:["assets/img/Trendiment_2.JPG"]},
  {title:"BayesBall Assistant", description:"Bayesian hierarchical model for season-long MLB player predictions.", images:["assets/img/Bayesball_Demo.JPG"]}
];

const publications=[
  {title:"Design of an Interactive Generalized Testbed for Continuous Data Collection and Reduced Maintenance Downtime in Industrial Applications: A Use Case Study Using Siemens MindSphere", description:"Mechanical failure study using FFT data.", images:["assets/img/IOT_ETL.JPG"]},
  {title:"Advancing Architectural Frameworks for Vibration Signature Classification in Rotating Machinery", description:"Integrated dataflow pipeline for predictive maintenance.", images:["assets/img/ML_Ensemble.JPG"]}
];

const certifications=[
  {title:"Databricks Generative AI Fundamentals", images:["assets/img/genai.png"]},
  {title:"Databricks Generative AI Application Development", images:["assets/img/genai_appdev.png"]},
  {title:"Nvidia Transformer Based NLP", images:["assets/img/nvidia.png"]},
  {title:"Google Advanced Data Analytics", images:["assets/img/google_adv.png"]},
  {title:"Engineer in Training"}
];

function populateBubbles(containerId,items,detailContainerId){
  const container=document.getElementById(containerId);
  container.innerHTML = "";
  const detail=document.getElementById(detailContainerId);
  items.forEach(item=>{
    const div=document.createElement("div");
    div.className="bubble";
    div.innerText=item.title;
    div.addEventListener("click",()=>{
      const active=document.querySelector(`#${containerId} .bubble.active`);
      if(active && active!==div) active.classList.remove("active");
      div.classList.toggle("active");
      if(div.classList.contains("active")){
        if(detail){
          detail.style.display="block";
          detail.innerHTML=`<h3>${item.title}</h3><p>${item.description || ""}</p>`+(item.images?.map(img=>`<img src="${img}">`).join("")||"");
        }
      } else {
        if(detail) detail.style.display="none";
      }
    });
    container.appendChild(div);
  });
}

/* --------------------------
   Skills network (UPGRADED)
   - connect similar skills via lines (same group)
   - clicking a node highlights it + neighbors
   - auto-link projects by keyword match
   - floating panel shows matched projects
   - auto zoom to selection and fit to window
   -------------------------- */

// skill groups: color-coded
const skillGroups={
  "Programming":{color:"#06d6a0", skills:["Python","R","SQL","PySpark","Power Query"]},
  "Visualization":{color:"#ffd166", skills:["Power BI","D3.js","Matplotlib","Tableau","Jupyter","Salesforce","VSCode"]},
  "Cloud/BigData":{color:"#ef476f", skills:["Azure","AWS","Databricks", "IoT", "NLP", "LLM Chains", "Sentiment Analysis"]},
  "Model Deployment":{color:"#ef476f", skills:["ETL", "Github", "MindSphere"]}, 
  "Engineering":{color:"#ef476f", skills:["Dynamics", "Vibrations", "Advanced Vibrations", "Thermodynamics"]},
  "Modeling/Analytics":{color:"#118ab2", skills:["Anomaly Detection", "Bayesian Modeling","Regression","Classification","Clustering", "ARIMA", "CUSUM", "Holt-Winters", "GARCH", "ElasticNet"]}
};

// build nodes (skills only) and links (connect similar skills inside group)
let nodes = [];
let links = [];

// add nodes
Object.entries(skillGroups).forEach(([group, g]) => {
  g.skills.forEach(skill => {
    nodes.push({ id: skill, group: group, color: g.color });
  });
});

// connect: fully connect within same group (or connect to nearest neighbors to avoid dense full mesh)
Object.values(skillGroups).forEach(g => {
  const s = g.skills;
  // connect sequential neighbors + a couple extras for web-like feel
  for(let i=0;i<s.length;i++){
    for(let j=i+1;j<s.length;j++){
      // create link with a small probability for non-adjacent to keep web structure reasonable
      const create = (j===i+1) || (Math.random() < 0.45);
      if(create) links.push({ source: s[i], target: s[j], type: "intra" });
    }
  }
});

// add a few deterministic cross-group semantic links (optional)
function maybeLink(a,b,prob=0.6){
  if(Math.random()<prob) links.push({ source:a, target:b, type:"cross" });
}
maybeLink("Python","Machine Learning",0.95);
maybeLink("Python","Bayesian Modeling",0.8);
maybeLink("SQL","Databricks",0.8);
maybeLink("D3.js","Power BI",0.35);
maybeLink("Azure","Databricks",0.9);

/* D3 setup */
const container = d3.select("#skillsGraph");
container.selectAll("*").remove(); // clear

const svg = container.append("svg").attr("width","100%").attr("height",560);
const width = container.node().clientWidth;
const height = 560;

// groups for zooming transforms
const gContainer = svg.append("g").attr("class","viewport");
const linkG = gContainer.append("g").attr("class","links");
const nodeG = gContainer.append("g").attr("class","nodes");
const labelG = gContainer.append("g").attr("class","labels");

// force simulation
const simulation = d3.forceSimulation(nodes)
  .force("charge", d3.forceManyBody().strength(-260))
  .force("center", d3.forceCenter(width/2, height/2))
  .force("collision", d3.forceCollide().radius(d=>28))
  .force("link", d3.forceLink(links).id(d=>d.id).distance(l => l.type==="intra"?90:140).strength(0.8));

/* Draw links and nodes */
const linkElems = linkG.selectAll("line")
  .data(links)
  .enter()
  .append("line")
  .attr("class","link-line")
  .attr("stroke-width",2)
  .attr("opacity",0.85);

const nodeElems = nodeG.selectAll("g.node")
  .data(nodes, d=>d.id)
  .enter()
  .append("g")
  .attr("class","node")
  .call(d3.drag()
    .on("start", dragStarted)
    .on("drag", dragged)
    .on("end", dragEnded)
  );

// circle
nodeElems.append("circle")
  .attr("class","skill-node")
  .attr("r",18)
  .attr("fill", d => d.color)
  .attr("stroke-width",1.2);

// label
nodeElems.append("text")
  .attr("class","skill-label")
  .attr("dy",5)
  .attr("text-anchor","middle")
  .text(d=>d.id)
  .style("font-size","11px");

/* tooltip */
const tooltip = d3.select("#skillTooltip");

/* helper: build adjacency map for quick neighbor lookup */
const adjacency = {};
nodes.forEach(n => adjacency[n.id] = new Set());
links.forEach(l => {
  adjacency[l.source instanceof Object ? l.source.id : l.source].add(l.target instanceof Object ? l.target.id : l.target);
  adjacency[l.target instanceof Object ? l.target.id : l.target].add(l.source instanceof Object ? l.source.id : l.source);
});

/* click -> highlight + show projects + zoom to fit */
let selectedNode = null;

nodeElems.on("mouseover", (event, d) => {
  tooltip.style("display","block")
    .style("left", (event.pageX + 12) + "px")
    .style("top", (event.pageY + 10) + "px")
    .html(`<strong>${d.id}</strong><div style="font-size:12px;opacity:0.85">${d.group}</div>`);
})
.on("mousemove", event => {
  tooltip.style("left", (event.pageX + 12) + "px")
         .style("top", (event.pageY + 10) + "px");
})
.on("mouseout", ()=> tooltip.style("display","none"))
.on("click", (event, d) => {
  event.stopPropagation();
  if(selectedNode && selectedNode.id === d.id) {
    clearSelection();
    return;
  }
  selectNode(d);
});

/* zoom behavior */
const zoom = d3.zoom()
  .scaleExtent([0.4, 3.5])
  .on("zoom", (event) => {
    gContainer.attr("transform", event.transform);
  });

svg.call(zoom);

// tick update
simulation.on("tick", () => {
  linkElems
    .attr("x1", d => getNodeById(d.source).x)
    .attr("y1", d => getNodeById(d.source).y)
    .attr("x2", d => getNodeById(d.target).x)
    .attr("y2", d => getNodeById(d.target).y);

  nodeElems.attr("transform", d => `translate(${d.x},${d.y})`);
});

/* helpers for d3 drag */
function dragStarted(event, d) {
  if (!event.active) simulation.alphaTarget(0.2).restart();
  d.fx = d.x;
  d.fy = d.y;
}
function dragged(event, d) {
  d.fx = event.x;
  d.fy = event.y;
}
function dragEnded(event, d) {
  if (!event.active) simulation.alphaTarget(0);
  // leave nodes fixed where dropped (gives user control). If you'd rather release them, uncomment:
  // d.fx = null; d.fy = null;
}

/* find node by id (handles if d.source is object or id) */
function getNodeById(n) {
  return (typeof n === "object" && n.x !== undefined) ? n : nodes.find(x => x.id === n);
}

/* selection logic */
function selectNode(d) {
  selectedNode = d;
  // dims others, highlights neighbors
  const neighbors = Array.from(adjacency[d.id] || []);
  nodeElems.selectAll("circle").attr("opacity", n => (n.id===d.id || neighbors.includes(n.id)) ? 1 : 0.18);
  nodeElems.selectAll("text").attr("opacity", n => (n.id===d.id || neighbors.includes(n.id)) ? 1 : 0.18);
  linkElems.attr("stroke", l => (l.source.id===d.id || l.target.id===d.id || neighbors.includes(l.source.id) || neighbors.includes(l.target.id)) ? "#ffd166" : "#2ec4b6")
           .attr("opacity", l => (l.source.id===d.id || l.target.id===d.id || neighbors.includes(l.source.id) || neighbors.includes(l.target.id)) ? 1 : 0.14)
           .attr("stroke-width", l => (l.source.id===d.id || l.target.id===d.id) ? 3 : 1.6);

  // show project panel with autolinked projects
  showProjectPanelForSkill(d.id);

  // zoom to fit selected cluster (node + neighbors)
  const clusterNodes = [d.id, ...neighbors].map(id => nodes.find(n=>n.id===id)).filter(Boolean);
  zoomToFit(clusterNodes, 80);
}

/* clear selection - reset visuals and hide panel */
function clearSelection() {
  selectedNode = null;
  nodeElems.selectAll("circle").attr("opacity", 1);
  nodeElems.selectAll("text").attr("opacity", 1);
  linkElems.attr("stroke","#2ec4b6").attr("opacity",0.9).attr("stroke-width",2);
  hideProjectPanel();
  zoomToFit(nodes, 60); // reset zoom to fit all
}

/* autolink projects (case-insensitive substring match against title or description) */
function getProjectsForSkill(skillName) {
  const key = skillName.toLowerCase();
  return projects.filter(p => {
    const combined = `${p.title} ${p.description}`.toLowerCase();
    return combined.includes(key) || (skillName.split(/\s+/).some(tok => combined.includes(tok.toLowerCase())));
  });
}

/* show project panel and populate */
const projPanel = document.getElementById("projPanel");
const projList = document.getElementById("projList");
const projSkillName = document.getElementById("projSkillName");
document.getElementById("clearSelection").addEventListener("click", clearSelection);

function showProjectPanelForSkill(skill) {
  const matched = getProjectsForSkill(skill);
  projSkillName.innerText = skill;
  projList.innerHTML = "";
  if(matched.length===0) {
    projList.innerHTML = `<div style="opacity:0.8">No projects automatically matched to <strong>${skill}</strong>.</div>`;
  } else {
    matched.forEach(p => {
      const div = document.createElement("div");
      div.className = "project-card";
      div.innerHTML = `<h4>${p.title}</h4><div style="font-size:13px;opacity:0.9">${p.description || ""}</div>` + (p.images && p.images.length? `<img src="${p.images[0]}" alt="${p.title}">` : "");
      projList.appendChild(div);
    });
  }
  projPanel.style.display = "block";
  projPanel.setAttribute("aria-hidden","false");
}

/* hide the floating panel */
function hideProjectPanel() {
  projPanel.style.display = "none";
  projPanel.setAttribute("aria-hidden","true");
}

/* click on background to clear selection */
svg.on("click", (event) => {
  // only clear if click target is svg (not nodes)
  if(event.target.tagName === 'svg') clearSelection();
});

/* FIT TO WINDOW & ZOOM helpers */
/* Compute bounding box for given nodes and smoothly zoom/pan to fit them */
function zoomToFit(targetNodes, padding=40, duration=750) {
  if(!targetNodes || targetNodes.length === 0) return;
  const xs = targetNodes.map(n=>n.x);
  const ys = targetNodes.map(n=>n.y);
  const minX = Math.min(...xs), maxX = Math.max(...xs);
  const minY = Math.min(...ys), maxY = Math.max(...ys);

  const bboxWidth = Math.max(1, maxX - minX);
  const bboxHeight = Math.max(1, maxY - minY);
  const svgRect = svg.node().getBoundingClientRect();
  const svgW = svgRect.width, svgH = svgRect.height;

  const scale = Math.max(0.4, Math.min(3.5, Math.min((svgW - padding) / bboxWidth, (svgH - padding) / bboxHeight)));
  const cx = (minX + maxX) / 2;
  const cy = (minY + maxY) / 2;

  const translate = [svgW / 2 - scale * cx, svgH / 2 - scale * cy];

  svg.transition().duration(duration).call(zoom.transform, d3.zoomIdentity.translate(translate[0], translate[1]).scale(scale));
}

/* fit whole graph on load/resize */
function fitAll() {
  // run a short stabilization then fit
  simulation.alpha(0.6);
  simulation.restart();
  setTimeout(()=> {
    simulation.alpha(0);
    zoomToFit(nodes, 160, 900);
  }, 800);
}

/* utility to ensure source/target are objects after forceLink resolves them */
function normalizeLinks() {
  // after simulation starts, link data source/target become node objects; adjacency built earlier uses ids - keep it consistent
}

/* On load */
populateTimeline("careerTimeline",careerData);
populateTimeline("educationTimeline",educationData);
animateTimeline("careerTimeline");
animateTimeline("educationTimeline");
populateBubbles("projectBubbles",projects,"projectDetails");
populateBubbles("pubBubbles",publications,"pubDetails");
populateBubbles("certBubbles",certifications,"");

// Wait a bit for layout then fit
setTimeout(()=> fitAll(), 1000);

/* On window resize, update center and re-fit */
window.addEventListener("resize", ()=> {
  const w = container.node().clientWidth;
  svg.attr("width", w);
  simulation.force("center", d3.forceCenter(w/2, height/2));
  simulation.alpha(0.3).restart();
  setTimeout(()=> zoomToFit(selectedNode ? [selectedNode, ...Array.from(adjacency[selectedNode.id]||[]).map(id => nodes.find(n=>n.id===id))].filter(Boolean) : nodes, 120, 600), 500);
});

/* add legend */
const legendDiv = container.append("div").attr("class","legend");
Object.entries(skillGroups).forEach(([k,v])=>{
  const item = legendDiv.append("div").attr("class","item");
  item.append("div").attr("class","swatch").style("background", v.color);
  item.append("div").style("font-size","13px").style("opacity",0.95).text(k);
});

/* initial tooltip hide */
tooltip.style("display","none");

</script>
</body>
</html>
